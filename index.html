<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 ì˜¤í‚¤ë‚˜ì™€ í—ˆë‹ˆë¬¸ í”Œë˜ë„ˆ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome (for icons instead of SVG) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F0F9FF; /* Light Ocean Blue */
            color: #334155; /* Slate 700 */
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 300px;
        }

        /* Custom Scrollbar for horizontal tabs */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .active-tab {
            background-color: #0EA5E9; /* Sky 500 */
            color: white;
            border-color: #0EA5E9;
        }
        
        .timeline-line {
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #CBD5E1;
            z-index: 0;
        }

        /* AI Chat Modal Animations */
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-up {
            animation: slideUp 0.3s ease-out forwards;
        }

        /* Markdown Styles in Chat */
        .prose p { margin-bottom: 0.5em; }
        .prose ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .prose strong { color: #0369a1; } /* Sky 700 */
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col relative">

    <!-- Navbar -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <i class="fa-solid fa-plane-departure text-sky-500 text-2xl mr-3"></i>
                    <h1 class="font-bold text-xl text-slate-800">Okinawa Honeymoon <span class="text-xs font-normal text-slate-500 block sm:inline">2025.12.02 - 12.09</span></h1>
                </div>
                <div class="text-sm font-medium text-sky-600">
                    Day <span id="current-day-display">1</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 space-y-12 pb-24">

        <!-- Section 1: Trip Overview & Stats -->
        <section id="overview" class="bg-white rounded-2xl shadow-sm p-6 border border-slate-100">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">ì—¬í–‰ ê°œìš”</h2>
                <p class="text-slate-600">
                    ì˜¤í‚¤ë‚˜ì™€ì˜ ë¶ë¶€ ìì—°, ì¤‘ë¶€ ì•¡í‹°ë¹„í‹°, ë‚¨ë¶€ ì‹œí‹° ë¼ì´í”„ë¥¼ ëª¨ë‘ ì¦ê¸°ëŠ” 7ë°• 8ì¼ í—ˆë‹ˆë¬¸ì…ë‹ˆë‹¤.
                    ì´ ì„¹ì…˜ì—ì„œëŠ” ì „ì²´ì ì¸ ì¼ì • ë°°ë¶„ê³¼ ë‚ ì”¨, ì´ë™ ê²½ë¡œì˜ ê· í˜•ì„ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <!-- Chart -->
                <div class="bg-slate-50 rounded-xl p-4">
                    <h3 class="text-center font-semibold text-slate-700 mb-4">ìˆ™ë°• ë° ì§€ì—­ ë°°ë¶„</h3>
                    <div class="chart-container">
                        <canvas id="tripChart"></canvas>
                    </div>
                </div>

                <!-- Summary Cards -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-sky-50 p-4 rounded-xl text-center">
                        <i class="fa-solid fa-car text-sky-500 text-2xl mb-2"></i>
                        <h4 class="font-bold text-slate-700">ë Œí„°ì¹´</h4>
                        <p class="text-xs text-slate-500">ë§ˆë¦¬ì˜¤ ë Œí„°ì¹´</p>
                        <p class="text-xs text-slate-500 mt-1">ì´ë™: ê³ ì†ë„ë¡œ(ë¶) â†’ êµ­ë„58(ë‚¨)</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-xl text-center">
                        <i class="fa-solid fa-sun text-orange-400 text-2xl mb-2"></i>
                        <h4 class="font-bold text-slate-700">12ì›” ë‚ ì”¨</h4>
                        <p class="text-xs text-slate-500">í‰ê·  20Â°C</p>
                        <p class="text-xs text-slate-500 mt-1">ì„ ì„ í•¨, ì–‡ì€ ê¸´íŒ” í•„ìˆ˜</p>
                    </div>
                    <div class="bg-emerald-50 p-4 rounded-xl text-center col-span-2">
                        <i class="fa-solid fa-heart text-emerald-500 text-2xl mb-2"></i>
                        <h4 class="font-bold text-slate-700">ì»¨ì…‰ ë°¸ëŸ°ìŠ¤</h4>
                        <div class="flex justify-between text-xs mt-2 px-4">
                            <span>íœ´ì–‘ (ë¶ë¶€/ì¤‘ë¶€)</span>
                            <span>ë„ì‹œ/ì‡¼í•‘ (ë‚¨ë¶€)</span>
                        </div>
                        <div class="w-full bg-emerald-200 rounded-full h-2.5 mt-1">
                            <div class="bg-emerald-500 h-2.5 rounded-full" style="width: 70%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Interactive Itinerary -->
        <section id="itinerary" class="bg-white rounded-2xl shadow-sm p-6 border border-slate-100">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">ì¼ë³„ ìƒì„¸ ì¼ì •</h2>
                <p class="text-slate-600">
                    ë¶ë¶€(3ë°•)ì—ì„œ ì‹œì‘í•˜ì—¬ ì¤‘ë¶€(2ë°•), ë‚¨ë¶€(2ë°•)ë¡œ ë‚´ë ¤ì˜¤ëŠ” íš¨ìœ¨ì ì¸ ë™ì„ ì…ë‹ˆë‹¤.
                    íƒ­ì„ í´ë¦­í•˜ì—¬ ë‚ ì§œë³„ ìƒì„¸ ë™ì„ ê³¼ ë§µì½”ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.
                </p>
            </div>

            <!-- Date Navigation -->
            <div class="flex overflow-x-auto space-x-2 pb-4 scrollbar-hide mb-6" id="date-tabs">
                <!-- Tabs will be injected by JS -->
            </div>

            <!-- Daily Content -->
            <div id="day-content" class="min-h-[400px]">
                <!-- Dynamic Content goes here -->
            </div>
        </section>

        <!-- Section 3: Food & Cafe Map -->
        <section id="food" class="bg-white rounded-2xl shadow-sm p-6 border border-slate-100">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">ë§›ì§‘ & ì¹´í˜ íƒë°©</h2>
                <p class="text-slate-600">
                    ì‘ì„±í•´ì£¼ì‹  ë¦¬ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§€ì—­ë³„ ì¶”ì²œ ë§›ì§‘ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. 
                    ì¹´ë“œë¥¼ í´ë¦­í•˜ë©´ ë³µì‚¬í•˜ê¸° ì‰¬ìš´ ë§µì½”ë“œê°€ í‘œì‹œë©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- North Food -->
                <div class="space-y-4">
                    <h3 class="font-bold text-lg text-emerald-600 border-b-2 border-emerald-100 pb-2">
                        <i class="fa-solid fa-tree mr-2"></i>ë¶ë¶€ (ìì—°/íë§)
                    </h3>
                    <div id="food-north-list" class="space-y-3">
                        <!-- JS Injected -->
                    </div>
                </div>
                <!-- Central Food -->
                <div class="space-y-4">
                    <h3 class="font-bold text-lg text-sky-600 border-b-2 border-sky-100 pb-2">
                        <i class="fa-solid fa-water mr-2"></i>ì¤‘ë¶€ (í•«í”Œ/ì¹´í˜)
                    </h3>
                    <div id="food-central-list" class="space-y-3">
                        <!-- JS Injected -->
                    </div>
                </div>
                <!-- South Food -->
                <div class="space-y-4">
                    <h3 class="font-bold text-lg text-indigo-600 border-b-2 border-indigo-100 pb-2">
                        <i class="fa-solid fa-city mr-2"></i>ë‚¨ë¶€ (ì‹œë‚´/ì´ìì¹´ì•¼)
                    </h3>
                    <div id="food-south-list" class="space-y-3">
                        <!-- JS Injected -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Map Code Quick Search -->
        <section class="bg-slate-800 text-white rounded-2xl shadow-lg p-8">
            <h2 class="text-xl font-bold mb-4"><i class="fa-solid fa-magnifying-glass mr-2"></i>ì£¼ìš” ëª…ì†Œ ë§µì½”ë“œ ë¹ ë¥¸ ê²€ìƒ‰</h2>
            <p class="text-slate-300 mb-4 text-sm">ë Œí„°ì¹´ ë„¤ë¹„ê²Œì´ì…˜ì— ì…ë ¥í•  ë²ˆí˜¸ë¥¼ ë¹ ë¥´ê²Œ ì°¾ìœ¼ì„¸ìš”.</p>
            <input type="text" id="mapcode-search" placeholder="ì¥ì†Œëª… ê²€ìƒ‰ (ì˜ˆ: ì¸„ë¼ìš°ë¯¸, ë§Œìëª¨)" 
                class="w-full p-3 rounded-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-sky-500">
            <div id="search-results" class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm">
                <!-- Results -->
            </div>
        </section>

    </main>

    <!-- Floating AI Button -->
    <div class="fixed bottom-6 right-6 z-50">
        <button onclick="toggleAIChat()" class="bg-gradient-to-r from-violet-500 to-fuchsia-500 hover:from-violet-600 hover:to-fuchsia-600 text-white rounded-full p-4 shadow-xl transition-all transform hover:scale-105 flex items-center gap-2">
            <i class="fa-solid fa-wand-magic-sparkles text-xl"></i>
            <span class="font-bold hidden sm:inline">AI ì»¨ì‹œì–´ì§€</span>
        </button>
    </div>

    <!-- AI Chat Modal -->
    <div id="ai-chat-modal" class="hidden fixed bottom-24 right-6 w-80 sm:w-96 bg-white rounded-2xl shadow-2xl border border-slate-200 z-50 flex flex-col overflow-hidden h-[500px]">
        <!-- Header -->
        <div class="bg-gradient-to-r from-violet-500 to-fuchsia-500 p-4 text-white flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-robot"></i>
                <h3 class="font-bold">AI ì—¬í–‰ ì»¨ì‹œì–´ì§€</h3>
            </div>
            <button onclick="toggleAIChat()" class="text-white hover:text-slate-200">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        
        <!-- Chat Area -->
        <div id="chat-messages" class="flex-grow p-4 overflow-y-auto bg-slate-50 space-y-4 text-sm">
            <!-- Intro Message -->
            <div class="flex items-start gap-2">
                <div class="bg-violet-100 p-2 rounded-full"><i class="fa-solid fa-robot text-violet-600"></i></div>
                <div class="bg-white p-3 rounded-lg shadow-sm border border-slate-100 max-w-[85%] text-slate-700">
                    ì•ˆë…•í•˜ì„¸ìš”! âœ¨<br>
                    ì˜¤í‚¤ë‚˜ì™€ ì‹ í˜¼ì—¬í–‰ ì¤‘ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?<br><br>
                    ê¶ê¸ˆí•œ ì ì„ ë¬¼ì–´ë³´ê±°ë‚˜ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”!
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="px-4 py-2 bg-white border-t border-slate-100 overflow-x-auto whitespace-nowrap scrollbar-hide flex gap-2">
            <button onclick="sendQuickPrompt('recommend')" class="px-3 py-1 bg-violet-50 text-violet-600 text-xs rounded-full border border-violet-100 hover:bg-violet-100">âœ¨ ë§›ì§‘ ì¶”ì²œí•´ì¤˜</button>
            <button onclick="sendQuickPrompt('translate')" class="px-3 py-1 bg-fuchsia-50 text-fuchsia-600 text-xs rounded-full border border-fuchsia-100 hover:bg-fuchsia-100">ğŸ—£ï¸ ì¼ë³¸ì–´ë¡œ ë²ˆì—­</button>
            <button onclick="sendQuickPrompt('weather')" class="px-3 py-1 bg-sky-50 text-sky-600 text-xs rounded-full border border-sky-100 hover:bg-sky-100">â˜”ï¸ ë¹„ ì˜¬ ë•Œ ì¶”ì²œ</button>
        </div>

        <!-- Input Area -->
        <div class="p-3 bg-white border-t border-slate-100 flex gap-2">
            <input type="text" id="ai-input" placeholder="ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”..." class="flex-grow bg-slate-100 border-0 rounded-full px-4 py-2 text-sm focus:ring-2 focus:ring-violet-300 outline-none" onkeypress="handleEnter(event)">
            <button onclick="sendMessage()" class="bg-violet-500 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-violet-600 transition-colors">
                <i class="fa-solid fa-paper-plane text-sm"></i>
            </button>
        </div>
    </div>

    <footer class="bg-white border-t border-slate-200 mt-12 py-8">
        <div class="container mx-auto px-4 text-center text-slate-500 text-sm">
            <p class="font-bold text-slate-700 mb-2">Happy Honeymoon</p>
            <p>ì•ˆì „ ìš´ì „í•˜ì„¸ìš” (ì¼ë³¸ì€ ì¢Œì¸¡ í†µí–‰ì…ë‹ˆë‹¤)</p>
            <p class="mt-2">Â© 2025 Okinawa Trip Planner with âœ¨ Gemini</p>
        </div>
    </footer>

    <script>
        // --- DATA STORAGE ---

        // 1. Itinerary Data (Core Logic)
        const itinerary = [
            {
                date: "12/2 (í™”)",
                day: 1,
                title: "ì˜¤í‚¤ë‚˜ì™€ ë„ì°© & ë¶ë¶€ ì´ë™",
                region: "North",
                stay: "ë¶ë¶€ ë¦¬ì¡°íŠ¸ (1ë°•)",
                schedule: [
                    { time: "12:00", activity: "ë‚˜í•˜ ê³µí•­ ë„ì°©", note: "ì…êµ­ ìˆ˜ì† ë° ì§ ì°¾ê¸°" },
                    { time: "13:30", activity: "ë Œí„°ì¹´ í”½ì—… (ë§ˆë¦¬ì˜¤ ë Œí„°ì¹´)", note: "ê³µí•­ í”½ì—… ë²„ìŠ¤ íƒ‘ìŠ¹ -> ì§€ì  ì´ë™", mapCode: "33 095 244*60 (ì§€ì  í™•ì¸ í•„ìš”)" },
                    { time: "14:30", activity: "ê³ ì†ë„ë¡œ ì´ë™ (ë‚˜í•˜ IC -> ì¿„ë‹¤ IC)", note: "ì•½ 1ì‹œê°„ 30ë¶„ ì†Œìš”. íœ´ê²Œì†Œ ë“¤ë¥´ê¸°" },
                    { time: "17:00", activity: "ë¶ë¶€ ìˆ™ì†Œ ì²´í¬ì¸ ë° íœ´ì‹", note: "ì¥ê±°ë¦¬ ë¹„í–‰/ìš´ì „ í”¼ë¡œ í’€ê¸°" },
                    { time: "18:30", activity: "ì €ë… ì‹ì‚¬ (ìˆ™ì†Œ ê·¼ì²˜ or ì•¼í‚¤ë‹ˆì¿ )", note: "ë¶ë¶€ ë§›ì§‘: ìº¡í‹´ ìº¥ê±°ë£¨(ë²„ê±°) ë˜ëŠ” ë°±ë…„ê³ ê°€ ìš°í›„ì•¼" }
                ]
            },
            {
                date: "12/3 (ìˆ˜)",
                day: 2,
                title: "ì¸„ë¼ìš°ë¯¸ì™€ ë¹„ì„¸í›„ì¿ ê¸¸",
                region: "North",
                stay: "ë¶ë¶€ ë¦¬ì¡°íŠ¸ (2ë°•)",
                schedule: [
                    { time: "10:00", activity: "ì¸„ë¼ìš°ë¯¸ ìˆ˜ì¡±ê´€", note: "ì˜¤í‚¤ì§± ì‡¼(ëŒê³ ë˜) ì‹œê°„ í™•ì¸ í•„ìˆ˜. ê³ ë˜ìƒì–´ ë³´ê¸°", mapCode: "553 075 797*77" },
                    { time: "13:00", activity: "ì ì‹¬: ì‚¿ì§±ì†Œë°”", note: "ìˆ˜ì¡±ê´€ ê·¼ì²˜ í˜„ì§€ì¸ ë§›ì§‘", mapCode: "553 046 397*55" },
                    { time: "14:30", activity: "ë¹„ì„¸í›„ì¿ ê¸¸ ì‚°ì±…", note: "ìì „ê±° ë ŒíŠ¸ ì¶”ì²œ. ì¡°ìš©í•œ ê°€ë¡œìˆ˜ê¸¸", mapCode: "553 105 654*77" },
                    { time: "16:30", activity: "ë¶ë¶€ ë“œë¼ì´ë¸Œ ë° ì¼ëª° ê°ìƒ", note: "ì„¸ì†Œì½”ì„¬ ëŒ€êµ ë“œë¼ì´ë¸Œ ì¶”ì²œ" },
                    { time: "19:00", activity: "ì €ë… ì‹ì‚¬ ë° íœ´ì‹", note: "í¸ì˜ì  í„¸ê¸° ë˜ëŠ” ë¦¬ì¡°íŠ¸ ë””ë„ˆ" }
                ]
            },
            {
                date: "12/4 (ëª©)",
                day: 3,
                title: "ì½”ìš°ë¦¬ ëŒ€êµ ë“œë¼ì´ë¸Œ & ë§¥ì£¼",
                region: "North",
                stay: "ë¶ë¶€ ë¦¬ì¡°íŠ¸ (3ë°•)",
                schedule: [
                    { time: "10:30", activity: "ì½”ìš°ë¦¬ ëŒ€êµ ë“œë¼ì´ë¸Œ", note: "ì˜¤í‚¤ë‚˜ì™€ ìµœê³ ì˜ ë“œë¼ì´ë¸Œ ì½”ìŠ¤. ì‰¬ë¦¼í”„ ì›¨ê±´ ê°„ì‹", mapCode: "485 662 041*33" },
                    { time: "12:00", activity: "ì½”ìš°ë¦¬ ì˜¤ì…˜ íƒ€ì›Œ", note: "ì „ë§ëŒ€ ê´€ëŒ (ì„ íƒ ì‚¬í•­)", mapCode: "485 693 485*06" },
                    { time: "14:00", activity: "ì˜¤ë¦¬ì˜¨ í•´í”¼íŒŒí¬ (ë§¥ì£¼ ê³µì¥)", note: "â˜…ìš´ì „ì ìŒì£¼ ì ˆëŒ€ ê¸ˆì§€ (ë…¼ì•Œì½œ ì œê³µ). ì‚¬ì „ ì˜ˆì•½ í•„ìˆ˜", mapCode: "206 598 867*44" },
                    { time: "16:00", activity: "ë„¤ì˜¤ íŒŒí¬ ë˜ëŠ” íŒŒì¸ì• í”Œ íŒŒí¬", note: "ê°€ë³ê²Œ ì‚°ì±…í•˜ê¸° ì¢‹ì€ ê³³ (ì„ íƒ)", mapCode: "206 684 640*41" },
                    { time: "18:30", activity: "ì €ë…: ì•¼ê°€ì§€ì„¬ ë˜ëŠ” ë‚˜ê³  ì‹œë‚´", note: "í˜„ì§€ ì´ìì¹´ì•¼ ì²´í—˜ (ëŒ€ë¦¬ìš´ì „ í•„ìˆ˜)" }
                ]
            },
            {
                date: "12/5 (ê¸ˆ)",
                day: 4,
                title: "ë¶ë¶€ì—ì„œ ì¤‘ë¶€ë¡œ ì´ë™ (Route 58)",
                region: "Central",
                stay: "ì¤‘ë¶€ í˜¸í…” (1ë°•)",
                schedule: [
                    { time: "10:00", activity: "ì²´í¬ì•„ì›ƒ ë° ë‚¨í•˜ ì‹œì‘", note: "58ë²ˆ êµ­ë„ íƒ€ê³  í•´ì•ˆ ë“œë¼ì´ë¸Œ" },
                    { time: "11:30", activity: "ë§Œìëª¨", note: "ì½”ë¼ë¦¬ ë°”ìœ„ ì ˆê²½ ê°ìƒ (ì§§ì€ ì½”ìŠ¤)", mapCode: "206 312 039*17" },
                    { time: "13:00", activity: "ì ì‹¬: ë‚˜ì¹´ë¬´ë¼ ì†Œë°” or íŒ¬ì¼€ì´í¬", note: "ë§Œìëª¨ ê·¼ì²˜ ë§›ì§‘" },
                    { time: "15:00", activity: "ì¤‘ë¶€ ìˆ™ì†Œ ì²´í¬ì¸", note: "ì•„ë©”ë¦¬ì¹¸ ë¹Œë¦¬ì§€ ê·¼ì²˜ ì¶”ì²œ" },
                    { time: "17:30", activity: "ì•„ë©”ë¦¬ì¹¸ ë¹Œë¦¬ì§€ ì•¼ê²½ & ì‡¼í•‘", note: "ê´€ëŒì°¨ëŠ” ì—†ì–´ì¡Œì§€ë§Œ ì•¼ê²½ì€ ì—¬ì „íˆ ì˜ˆì¨", mapCode: "33 526 450*63" },
                    { time: "19:00", activity: "ì €ë…: êµ¬ë¥´ë©” ìŠ¤ì‹œ or ìŠ¤í…Œì´í¬", note: "ì•„ë©”ë¹Œ ë‚´ ë§›ì§‘ ë§ìŒ" }
                ]
            },
            {
                date: "12/6 (í† )",
                day: 5,
                title: "í‘¸ë¥¸ë™êµ´ê³¼ ì¹´í˜ íˆ¬ì–´",
                region: "Central",
                stay: "ì¤‘ë¶€ í˜¸í…” (2ë°•)",
                schedule: [
                    { time: "09:00", activity: "í‘¸ë¥¸ë™êµ´ ìŠ¤ë…¸í´ë§/ë‹¤ì´ë¹™", note: "ë§ˆì—ë‹¤ ê³¶. ì‚¬ì „ ì˜ˆì•½ í•„ìˆ˜. ë¬¼ë†€ì´", mapCode: "206 062 685*85" },
                    { time: "12:30", activity: "ì ì‹¬: ì‚°ìŠ¤ì‹œ (êµí† ì‹)", note: "ê¹”ë”í•œ ì¼ì‹ ì •ì‹", mapCode: "33 466 690*71" },
                    { time: "14:30", activity: "ë°˜íƒ€ ì¹´í˜ (í˜¸ì‹œë…¸ ë¦¬ì¡°íŠ¸)", note: "ë°”ë‹¤ ë·°ê°€ ì••ë„ì ì¸ ëŒ€í˜• ì¹´í˜", mapCode: "33 882 485*82" },
                    { time: "16:30", activity: "í•´ì¤‘ë„ë¡œ ë“œë¼ì´ë¸Œ", note: "ë°”ë‹¤ë¥¼ ê°€ë¥´ëŠ” ê¸´ ë‹¤ë¦¬. ì—¬ìœ ë¡œìš´ ë“œë¼ì´ë¸Œ", mapCode: "499 576 274*33" },
                    { time: "19:00", activity: "ì €ë…: ì´ì‹œêµ¬í›„ (ì†Œë°”) ë“±", note: "ë‹­ìœ¡ìˆ˜ ì†Œë°”ê°€ ìœ ëª…í•¨" }
                ]
            },
            {
                date: "12/7 (ì¼)",
                day: 6,
                title: "ë¯¸ë‚˜í† ê°€ì™€ & ë‚˜í•˜ ì…ì„±",
                region: "South",
                stay: "ë‚¨ë¶€ í˜¸í…” (1ë°•)",
                schedule: [
                    { time: "10:30", activity: "ì²´í¬ì•„ì›ƒ ë° ì´ë™", note: "ë‚˜í•˜ì‹œ ë°©í–¥ìœ¼ë¡œ ì´ë™" },
                    { time: "11:30", activity: "ë¯¸ë‚˜í† ê°€ì™€ ìŠ¤í…Œì´íŠ¸ì‚¬ì´ë“œ íƒ€ìš´", note: "ë¯¸êµ° ì£¼íƒ ê°œì¡° ê±°ë¦¬. ì‚¬ì§„ ì°ê¸° ì¢‹ìŒ", mapCode: "33 341 033*55" },
                    { time: "12:00", activity: "ì ì‹¬ & ì¹´í˜: ì˜¤í•˜ì½”ë¥´í…Œ, ì„¸ë¼ë„ ì»¤í”¼", note: "íƒ€ë¥´íŠ¸ ë§›ì§‘, ë¡œìŠ¤í„°ë¦¬ ì»¤í”¼" },
                    { time: "15:00", activity: "ë‚˜í•˜ í˜¸í…” ì²´í¬ì¸", note: "êµ­ì œê±°ë¦¬ ë„ë³´ ì´ë™ ê°€ëŠ¥í•œ ê³³ ì¶”ì²œ" },
                    { time: "17:00", activity: "êµ­ì œê±°ë¦¬ ì‡¼í•‘ (ëˆí‚¤í˜¸í…Œ ë“±)", note: "ê¸°ë…í’ˆ êµ¬ë§¤", mapCode: "33 157 435*41" },
                    { time: "19:00", activity: "ì €ë…: ì•¼í‚¤ë‹ˆì¿  í”Œì‹¬ (ìˆ  ë¬´ì œí•œ)", note: "ì˜ˆì•½ ì¶”ì²œ. ì²œì—” ìˆ  ë¬´ì œí•œ ì¦ê¸°ê¸°", mapCode: "33 157 532*71" }
                ]
            },
            {
                date: "12/8 (ì›”)",
                day: 7,
                title: "ë‚¨ë¶€ ê´€ê´‘ê³¼ ë§ˆì§€ë§‰ ë°¤",
                region: "South",
                stay: "ë‚¨ë¶€ í˜¸í…” (2ë°•)",
                schedule: [
                    { time: "10:00", activity: "ìŠˆë¦¬ì„± ì‚°ì±…", note: "ë¥˜í ì™•êµ­ì˜ ì—­ì‚¬ (ì¼ë¶€ ë³µì› ê³µì‚¬ì¤‘ì¼ ìˆ˜ ìˆìŒ)", mapCode: "33 161 526*55" },
                    { time: "12:30", activity: "ì ì‹¬: ë§ˆì œë©˜ ë§ˆí˜¸ë¡œë°”", note: "êµ­ì œê±°ë¦¬ ê·¼ì²˜ ë¹„ë¹”ë¼ë©˜ ë§›ì§‘", mapCode: "33 157 266*82" },
                    { time: "14:30", activity: "ìš°ë¯¸ì¹´ì§€ í…Œë¼ìŠ¤", note: "ê³µí•­ ê·¼ì²˜ í•˜ì–€ ê±´ë¬¼ ì‡¼í•‘ëª°. ë¹„í–‰ê¸° ì´ì°©ë¥™ ë·°", mapCode: "33 002 602*06" },
                    { time: "17:00", activity: "ë§ˆì§€ë§‰ ì‡¼í•‘ (ë¥˜ë³´ ë°±í™”ì  ë“±)", note: "í”„ë‘í”„ë‘, ë¬´ì¸ì–‘í’ˆ ë“±" },
                    { time: "19:30", activity: "ë§ˆì§€ë§‰ ë§Œì°¬ (ì´ìì¹´ì•¼)", note: "í¬ì¥ë§ˆì°¨ ê±°ë¦¬(ì•¼íƒ€ì´ë¬´ë¼) ë¶„ìœ„ê¸° ì¦ê¸°ê¸°", mapCode: "33 157 406*41" }
                ]
            },
            {
                date: "12/9 (í™”)",
                day: 8,
                title: "ê·€êµ­",
                region: "South",
                stay: "ì§‘ìœ¼ë¡œ",
                schedule: [
                    { time: "09:00", activity: "ì²´í¬ì•„ì›ƒ", note: "ì§ ë¹ ì§„ ê²ƒ ì—†ëŠ”ì§€ í™•ì¸" },
                    { time: "10:00", activity: "ë Œí„°ì¹´ ë°˜ë‚©", note: "ë§ˆë¦¬ì˜¤ ë Œí„°ì¹´ ë°˜ë‚© í›„ ê³µí•­ ì…”í‹€ íƒ‘ìŠ¹. (ì£¼ìœ  í•„ìˆ˜!)" },
                    { time: "11:00", activity: "ë‚˜í•˜ ê³µí•­ ë„ì°©", note: "ë©´ì„¸ì  ì‡¼í•‘ ë° ì ì‹¬ ì‹ì‚¬" },
                    { time: "13:00", activity: "ì¶œêµ­", note: "í–‰ë³µí–ˆë˜ ì‹ í˜¼ì—¬í–‰ ë§ˆë¬´ë¦¬" }
                ]
            }
        ];

        // 2. Food Data
        const foodPlaces = {
            north: [
                { name: "ì‚¿ì§±ì†Œë°”", desc: "ì¸„ë¼ìš°ë¯¸ ê°€ëŠ” ê¸¸ í˜„ì§€ ë§›ì§‘, ì„¸íŠ¸ 1000ì—”ëŒ€", map: "553 046 397*55" },
                { name: "ì˜¤ë¦¬ì˜¨ í•´í”¼íŒŒí¬", desc: "ê³µì¥ ê²¬í•™ ë° ê°“ ë§Œë“  ë§¥ì£¼ ì‹œìŒ", map: "206 598 867*44" },
                { name: "ì‰¬ë¦¼í”„ ì›¨ê±´", desc: "ì½”ìš°ë¦¬ ëŒ€êµ ëª…ë¬¼ ê°ˆë¦­ ì‰¬ë¦¼í”„", map: "485 692 129*71" }
            ],
            central: [
                { name: "ë¯¸ë‚˜í† ê°€ì™€ ì˜¤í•˜ì½”ë¥´í…Œ", desc: "ê³¼ì¼ íƒ€ë¥´íŠ¸ ì „ë¬¸ì , ê°ì„± ì¸í…Œë¦¬ì–´", map: "33 341 002*28" },
                { name: "ì„¸ë¼ë„ ì»¤í”¼", desc: "ì§ì ‘ ë¡œìŠ¤íŒ…í•œ ì›ë‘, ë¯¸ë‚˜í† ê°€ì™€", map: "33 341 062*77" },
                { name: "ì´ì‹œêµ¬í›„", desc: "ì˜¤í‚¤ë‚˜ì™€ ì´ˆëŒ€ ì†Œë°” ì™•ì¢Œ, ë‹­ìœ¡ìˆ˜", map: "33 341 123*22" },
                { name: "í”Œë¼ìš°ë§ŒìŠ¤ ëŸ°ì¹˜ ë² ì´ì»¤ë¦¬", desc: "ì–¸ë• ìœ„ ë¹µê³¼ ë¸ŒëŸ°ì¹˜, ë·° ë§›ì§‘", map: "33 440 259*55" },
                { name: "ì‚°ìŠ¤ì‹œ", desc: "ì •ê°ˆí•œ êµí† ì‹ ì¼ì‹ ìš”ë¦¬", map: "33 466 690*71" },
                { name: "ë°˜íƒ€ ì¹´í˜", desc: "í˜¸ì‹œë…¸ ë¦¬ì¡°íŠ¸ ìš´ì˜, ì••ë„ì  ì˜¤ì…˜ë·°", map: "33 882 485*82" }
            ],
            south: [
                { name: "ì•¼ë¼ë‹ˆê¾¸ í”Œì‹¬", desc: "êµ­ì œê±°ë¦¬, 1000ì—” ìˆ  ë¬´ì œí•œ ì•¼í‚¤ë‹ˆì¿ ", map: "33 157 532*71" },
                { name: "ë§ˆì œë©˜ ë§ˆí˜¸ë¡œë°”", desc: "ì¤‘ë…ì„± ìˆëŠ” ë¹„ë¹”ë¼ë©˜", map: "33 157 266*82" },
                { name: "í¬ì¥ë§ˆì°¨ ê±°ë¦¬ (ì•¼íƒ€ì´ë¬´ë¼)", desc: "ë‹¤ì–‘í•œ ì•ˆì£¼ì™€ ìˆ , í™œê¸°ì°¬ ë¶„ìœ„ê¸°", map: "33 157 406*41" }
            ]
        };

        // 3. Global Code Map for Search
        const searchCodes = [
            { name: "ì¸„ë¼ìš°ë¯¸ ìˆ˜ì¡±ê´€", code: "553 075 797*77" },
            { name: "ì½”ìš°ë¦¬ ëŒ€êµ", code: "485 662 041*33" },
            { name: "ë§Œìëª¨", code: "206 312 039*17" },
            { name: "ì•„ë©”ë¦¬ì¹¸ ë¹Œë¦¬ì§€", code: "33 526 450*63" },
            { name: "í‘¸ë¥¸ë™êµ´(ë§ˆì—ë‹¤ê³¶)", code: "206 062 685*85" },
            { name: "ë¯¸ë‚˜í† ê°€ì™€ ìŠ¤í…Œì´íŠ¸ì‚¬ì´ë“œ", code: "33 341 033*55" },
            { name: "ìŠˆë¦¬ì„±", code: "33 161 526*55" },
            { name: "ìš°ë¯¸ì¹´ì§€ í…Œë¼ìŠ¤", code: "33 002 602*06" },
            { name: "êµ­ì œê±°ë¦¬(ì…êµ¬)", code: "33 157 435*41" },
            { name: "ì˜¤ë¦¬ì˜¨ í•´í”¼íŒŒí¬", code: "206 598 867*44" },
            { name: "ì´ì˜¨ëª° ë¼ì´ì¹´ë¬´", code: "33 530 406*45" }
        ];

        // --- FUNCTIONS ---

        // Render Chart
        function initCharts() {
            const ctx = document.getElementById('tripChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ë¶ë¶€ (íë§/ìì—°)', 'ì¤‘ë¶€ (ì•¡í‹°ë¹„í‹°/ì¹´í˜)', 'ë‚¨ë¶€ (ë„ì‹œ/ì‡¼í•‘)'],
                    datasets: [{
                        data: [3, 2, 2], // 3 nights, 2 nights, 2 nights
                        backgroundColor: [
                            '#10B981', // Emerald 500
                            '#0EA5E9', // Sky 500
                            '#6366F1'  // Indigo 500
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + 'ë°•';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Render Itinerary Tabs & Content
        function renderItinerary() {
            const tabContainer = document.getElementById('date-tabs');
            const contentContainer = document.getElementById('day-content');
            
            // Create Tabs
            itinerary.forEach((day, index) => {
                const btn = document.createElement('button');
                btn.className = `flex-shrink-0 px-4 py-2 rounded-full border text-sm font-medium transition-colors ${index === 0 ? 'active-tab' : 'bg-white text-slate-500 border-slate-200 hover:bg-slate-50'}`;
                btn.innerText = day.date;
                btn.onclick = () => switchTab(index);
                tabContainer.appendChild(btn);
            });

            // Initial Render
            switchTab(0);
        }

        function switchTab(index) {
            // Update Tab Styles
            const tabs = document.getElementById('date-tabs').children;
            for(let i=0; i<tabs.length; i++) {
                if(i === index) {
                    tabs[i].className = 'flex-shrink-0 px-4 py-2 rounded-full border text-sm font-medium transition-colors active-tab';
                } else {
                    tabs[i].className = 'flex-shrink-0 px-4 py-2 rounded-full border text-sm font-medium transition-colors bg-white text-slate-500 border-slate-200 hover:bg-slate-50';
                }
            }

            // Update Content
            const data = itinerary[index];
            const contentContainer = document.getElementById('day-content');
            document.getElementById('current-day-display').innerText = data.day;

            let scheduleHTML = '';
            data.schedule.forEach(item => {
                scheduleHTML += `
                    <div class="relative pl-8 pb-8 group">
                        <!-- Timeline Dot -->
                        <div class="absolute left-0 top-1 w-4 h-4 rounded-full border-2 border-white shadow-sm z-10 ${index < 3 ? 'bg-emerald-500' : (index < 5 ? 'bg-sky-500' : 'bg-indigo-500')}"></div>
                        
                        <div class="bg-slate-50 rounded-xl p-4 card-hover border border-slate-100">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-slate-800 text-lg">${item.time}</span>
                                ${item.mapCode ? `<span class="text-xs bg-slate-200 text-slate-600 px-2 py-1 rounded cursor-pointer hover:bg-slate-300" onclick="navigator.clipboard.writeText('${item.mapCode.split('(')[0].trim()}')"><i class="fa-solid fa-copy mr-1"></i>${item.mapCode}</span>` : ''}
                            </div>
                            <h4 class="font-bold text-base text-slate-700 mb-1">${item.activity}</h4>
                            <p class="text-sm text-slate-500">${item.note}</p>
                        </div>
                    </div>
                `;
            });

            contentContainer.innerHTML = `
                <div class="bg-white rounded-xl p-4 mb-4 border-l-4 ${index < 3 ? 'border-emerald-500' : (index < 5 ? 'border-sky-500' : 'border-indigo-500')} shadow-sm">
                    <h3 class="text-xl font-bold text-slate-800">${data.title}</h3>
                    <p class="text-sm text-slate-500 mt-1"><i class="fa-solid fa-bed mr-2"></i>ìˆ™ì†Œ: ${data.stay}</p>
                </div>
                <div class="relative mt-6">
                    <div class="timeline-line"></div>
                    ${scheduleHTML}
                </div>
            `;
        }

        // Render Food Lists
        function renderFood() {
            const createCard = (item) => `
                <div class="bg-slate-50 p-3 rounded-lg border border-slate-100 card-hover cursor-pointer" onclick="navigator.clipboard.writeText('${item.map.split('*')[0]}')">
                    <div class="flex justify-between items-center">
                        <h4 class="font-bold text-slate-700">${item.name}</h4>
                        <i class="fa-solid fa-location-dot text-slate-400 text-xs"></i>
                    </div>
                    <p class="text-xs text-slate-500 mt-1">${item.desc}</p>
                    <div class="mt-2 text-xs font-mono text-slate-400 bg-white p-1 rounded inline-block border border-slate-200">
                        Map: ${item.map}
                    </div>
                </div>
            `;

            document.getElementById('food-north-list').innerHTML = foodPlaces.north.map(createCard).join('');
            document.getElementById('food-central-list').innerHTML = foodPlaces.central.map(createCard).join('');
            document.getElementById('food-south-list').innerHTML = foodPlaces.south.map(createCard).join('');
        }

        // Map Code Search
        function initSearch() {
            const input = document.getElementById('mapcode-search');
            const resultDiv = document.getElementById('search-results');

            input.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                if(query.length < 1) {
                    resultDiv.innerHTML = '';
                    return;
                }

                const filtered = searchCodes.filter(item => item.name.toLowerCase().includes(query));
                
                if(filtered.length === 0) {
                    resultDiv.innerHTML = '<p class="text-slate-400 col-span-2 text-center">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }

                resultDiv.innerHTML = filtered.map(item => `
                    <div class="bg-slate-700 p-3 rounded flex justify-between items-center hover:bg-slate-600 transition cursor-pointer" onclick="navigator.clipboard.writeText('${item.code.split('*')[0]}')">
                        <span>${item.name}</span>
                        <span class="font-mono text-sky-300 text-xs">${item.code} <i class="fa-solid fa-copy ml-1"></i></span>
                    </div>
                `).join('');
            });
        }

        // --- GEMINI API INTEGRATION ---
        
        // ìˆ˜ì •ëœ ë¶€ë¶„: API í‚¤ë¥¼ ì½”ë“œì— ì§ì ‘ ë„£ì§€ ì•Šê³  ë¸Œë¼ìš°ì €ì—ì„œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
        function getApiKey() {
            let key = localStorage.getItem('gemini_api_key');
            if (!key) {
                key = prompt("Gemini API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n(ì…ë ¥ëœ í‚¤ëŠ” ì´ ê¸°ê¸°ì˜ ë¸Œë¼ìš°ì €ì—ë§Œ ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤.)");
                if (key) {
                    localStorage.setItem('gemini_api_key', key);
                    alert("API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ AI ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            }
            return key;
        }

        // í‚¤ë¥¼ ì˜ëª» ì…ë ¥í–ˆì„ ë•Œ ì´ˆê¸°í™”í•˜ëŠ” ê¸°ëŠ¥
        function resetApiKey() {
            if(confirm("ì €ì¥ëœ API í‚¤ë¥¼ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì…ë ¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                localStorage.removeItem('gemini_api_key');
                location.reload();
            }
        }

        let isChatOpen = false;

        function toggleAIChat() {
            const modal = document.getElementById('ai-chat-modal');
            isChatOpen = !isChatOpen;
            if (isChatOpen) {
                // ì±„íŒ…ì°½ ì—´ ë•Œ í‚¤ê°€ ì—†ìœ¼ë©´ ë¬¼ì–´ë´„
                if(!localStorage.getItem('gemini_api_key')) {
                    getApiKey();
                }
                modal.classList.remove('hidden');
                modal.classList.add('animate-slide-up');
                setTimeout(() => document.getElementById('ai-input').focus(), 300);
            } else {
                modal.classList.add('hidden');
            }
        }

        function sendQuickPrompt(type) {
            let prompt = "";
            switch(type) {
                case 'recommend':
                    prompt = "ì˜¤í‚¤ë‚˜ì™€ ì—¬í–‰ ì¤‘ì¸ë°, ë¡œë§¨í‹±í•œ ë¶„ìœ„ê¸°ì˜ ë§›ì§‘ì´ë‚˜ ìˆ¨ê²¨ì§„ ëª…ì†Œ í•˜ë‚˜ë§Œ ì¶”ì²œí•´ì¤˜. ë„ˆë¬´ ê¸¸ì§€ ì•Šê²Œ í•µì‹¬ë§Œ.";
                    break;
                case 'translate':
                    prompt = "ì¼ë³¸ ì—¬í–‰ ì¤‘ ì‹ë‹¹ì´ë‚˜ í˜¸í…”ì—ì„œ ìì£¼ ì“°ëŠ” ìœ ìš©í•œ ì¼ë³¸ì–´ ë¬¸ì¥ 3ê°œë§Œ ì•Œë ¤ì¤˜ (ë°œìŒ í¬í•¨).";
                    break;
                case 'weather':
                    prompt = "ì˜¤í‚¤ë‚˜ì™€ì— ë¹„ê°€ ì˜¬ ë•Œ í•  ìˆ˜ ìˆëŠ” ì‹¤ë‚´ ë°ì´íŠ¸ ì½”ìŠ¤ë‚˜ í™œë™ ì¶”ì²œí•´ì¤˜.";
                    break;
            }
            document.getElementById('ai-input').value = prompt;
            sendMessage();
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }

        async function sendMessage() {
            // í‚¤ í™•ì¸
            const apiKey = getApiKey();
            if (!apiKey) {
                alert("API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.");
                return;
            }

            const input = document.getElementById('ai-input');
            const message = input.value.trim();
            if (!message) return;

            // Add User Message to Chat
            addMessageToChat('user', message);
            input.value = '';

            // Show Loading
            const loadingId = addMessageToChat('ai', '<i class="fa-solid fa-spinner fa-spin"></i> ìƒê° ì¤‘...');

            try {
                // ìˆ˜ì •ëœ ë¶€ë¶„: í•¨ìˆ˜ ì¸ìë¡œ apiKey ì „ë‹¬
                const response = await callGemini(message, apiKey);
                updateMessage(loadingId, response);
            } catch (error) {
                updateMessage(loadingId, "ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                console.error(error);
            }
        }
        
            if (role === 'user') {
        async function callGemini(userPrompt, key) {
            const systemPrompt = "ë‹¹ì‹ ì€ ì˜¤í‚¤ë‚˜ì™€ í—ˆë‹ˆë¬¸ ì—¬í–‰ì„ ë•ëŠ” ë¡œë§¨í‹±í•˜ê³  ì¹œì ˆí•œ AI ì»¨ì‹œì–´ì§€ì…ë‹ˆë‹¤. ì‹ í˜¼ë¶€ë¶€ë¥¼ ìœ„í•´ ë‹¤ì •í•˜ê²Œ ëŒ€ë‹µí•´ì£¼ì„¸ìš”. ë‹µë³€ì€ ëª¨ë°”ì¼ì—ì„œ ì½ê¸° ì‰½ê²Œ ì§§ê³  ê°„ê²°í•˜ê²Œ(300ì ì´ë‚´) ì‘ì„±í•˜ì„¸ìš”. ì¼ë³¸ì–´ íšŒí™” ìš”ì²­ ì‹œ ë°œìŒê³¼ ì˜ë¯¸ë¥¼ ì •í™•íˆ ì•Œë ¤ì£¼ì„¸ìš”. ë§›ì§‘ ì¶”ì²œ ì‹œ ë§µì½”ë“œê°€ ìˆë‹¤ë©´ ì¢‹ê² ì§€ë§Œ ì—†ì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤.";
            
            try {
                // ìˆ˜ì •ëœ ë¶€ë¶„: ì „ë‹¬ë°›ì€ key ì‚¬ìš©
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${key}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: userPrompt }]
                        }],
                        systemInstruction: {
                            parts: [{ text: systemPrompt }]
                        }
                    })
                });

                if (!response.ok) {
                    if (response.status === 400 || response.status === 403) {
                        throw new Error('API Keyê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í‚¤ë¥¼ ì¬ì„¤ì •í•´ì£¼ì„¸ìš”.');
                    }
                    throw new Error('Network response was not ok');
                }
                
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error('Gemini API Error:', error);
                if (error.message.includes('API Key')) {
                    resetApiKey(); // í‚¤ ì—ëŸ¬ ë°œìƒ ì‹œ ì¬ì„¤ì • ìœ ë„
                }
                throw error;
            }
        }

        // Initialize Everything
        window.addEventListener('DOMContentLoaded', () => {
            initCharts();
            renderItinerary();
            renderFood();
            initSearch();
        });

    </script>
</body>
</html>